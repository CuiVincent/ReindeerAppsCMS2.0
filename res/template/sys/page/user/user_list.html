<!DOCTYPE html>
<html>
<head lang="zh-cmn-Hans">
    {% include '../../../common_header_base.html' %}
    {% include '../../../common_header_datatable.html' %}
    {% include '../../../common_header_validate.html' %}
    <title></title>
    <script>
        function initTable() {
            initDataTable($('#table'), "user_list", [
                { "mDataProp": "ID", "bSortable": false, "bSearchable": false, "sClass": "data-table-operation",
                    "mRender": function (data, type, full) {
                        return '<input id="' + data + '" class="table_checkbox" type="checkbox" />';
                    }},
                { "mDataProp": "CODE"},
                { "mDataProp": "NAME" },
                { "mDataProp": "STATUS",
                    "mRender": function (data, type, full) {
                        if (data == '1') {
                            return '正常';
                        }
                        else if (data == '3') {
                            return '已删除';
                        }
                        return '已禁用';
                    }},
                { "mDataProp": "C_USER"  },
                { "mDataProp": "C_DATE" },
                { "mDataProp": "ID", "bSortable": false, "bSearchable": false, "sClass": "data-table-operation", "sWidth": "20%",
                    "mRender": function (data, type, full) {
                        return  '<button class="btn btn-primary  btn-xs"  onclick="doEdit(\'' + data + '\',\'' + full.CODE + '\',\'' + full.NAME + '\',\'' + full.STATUS + '\');"><span class="glyphicon glyphicon-pencil" aria-hidden="true"></span></button>' +
                                '<button class="btn btn-reindeer btn-xs"  onclick="doDelete(\'' + data + '\');"><span class="glyphicon glyphicon-trash" aria-hidden="true"></span></button>' +
                                '<button class="btn btn-success btn-xs"  onclick="doAddToGroup(\'' + data + '\');"><span class="glyphicon glyphicon-flag" aria-hidden="true"></span></button>';
                    }}
            ], true, [
                [ 4, "desc" ]
            ]);
        }
        $(document).ready(function () {
            initTable();
        });
        function doAddToGroup(uid) {
            ajaxCommitWithGritter('group_user_add', [
                {name: 'uid', value: uid},
                {name: 'gid', value: "c5fe606e-2671-11e5-a898-a41731d16198"}
            ], doRefresh);
        }
    </script>
</head>
<body class="container content-body">
<div class="content-body-title">
    <h4>用户管理</h4>

    <div class="content-body-title-button">
        <button class="btn btn-primary btn-sm" onclick="doAdd();"><span class="glyphicon glyphicon-plus-sign"
                                                                        aria-hidden="true"></span>&nbsp;新建
        </button>
        <button class="btn btn-reindeer btn-sm" onclick="doBatchDelete();"><span class="glyphicon glyphicon-trash"
                                                                                 aria-hidden="true"></span>&nbsp;批量删除
        </button>
        <button class="btn btn-success btn-sm" onclick="doRefresh();"><span class="glyphicon glyphicon-refresh"
                                                                            aria-hidden="true"></span>
        </button>
    </div>
</div>
<hr>
<div class="content-body-info">
    <table id="table" class="table data-table">
        <thead>
        <tr>
            <th><input type="checkbox" name="data-table-title-checkbox"/></th>
            <th>用户名</th>
            <th>昵称</th>
            <th>状态</th>
            <th>创建人</th>
            <th>创建时间</th>
            <th>操作</th>
        </tr>
        </thead>
        <tbody>
        </tbody>
    </table>
</div>
{% include 'user_add.html' %}
{% include 'user_edit.html' %}
{% include 'user_delete.html' %}
</body>
</html>

